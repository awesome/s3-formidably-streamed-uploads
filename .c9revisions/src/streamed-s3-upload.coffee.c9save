{"ts":1356031201389,"silentsave":true,"restoring":false,"patch":[[]],"length":0}
{"contributors":[],"silentsave":false,"ts":1356031251435,"patch":[[{"diffs":[[1,"async = require 'async'\r\ngm = (require 'gm').subClass { imageMagick: true }\r\nformidable = require 'formidable'\r\nknox = require 'knox'\r\nMultiPartUpload = require 'knox-mpu'"]],"start1":0,"start2":0,"length1":0,"length2":171}]],"length":171,"saved":false}
{"ts":1356031287213,"patch":[[{"diffs":[[0,"c'\r\n"],[-1,"gm = (require 'gm').subClass { imageMagick: true }\r\n"],[0,"form"]],"start1":21,"start2":21,"length1":60,"length2":8}]],"length":119,"saved":false}
{"ts":1356031365039,"patch":[[{"diffs":[[0,"nox-mpu'"],[1,"\r\n\r\nmodule.exports = ->\r\n  pushToS3 = (objectName, stream, cb) ->\r\n    console.time \"[ image-uploader-helper ] Pushing to S3\"\r\n\r\n    mpu = new MultiPartUpload\r\n      client: global.knoxClient\r\n      objectName: objectName\r\n      stream: stream\r\n      cb\r\n      \r\n  handleFilePart = (part, cb) ->\r\n    # https://groups.google.com/forum/?fromgroups=#!topic/nodejs/Avf95ibIqHo\r\n    async.forEach thumbnailSizes,\r\n      (size, cb) ->\r\n        saveThumbnail part, size, cb\r\n      (err) ->\r\n        cb err\r\n      \r\n"]],"start1":111,"start2":111,"length1":8,"length2":517}]],"length":628,"saved":false}
{"ts":1356031430465,"patch":[[{"diffs":[[0,"cb err\r\n      \r\n"],[1,"  handleImageUpload = (req, res, next) ->\r\n    form = new formidable.IncomingForm()\r\n\r\n    form.keepExtensions = true\r\n    form.uploadDir = process.env.TMP || process.env.TMPDIR || process.env.TEMP || '/tmp' || process.cwd()\r\n    form.onPart = (part) ->\r\n      console.log '**onPart'\r\n      if not part.filename then form.handlePart part\r\n      else\r\n        handleFilePart part, (err, res) ->\r\n          if err?\r\n            console.error err\r\n            @emit 'error', err\r\n          else @emit 'end'\r\n\r\n    form.parse req, (err, fields, files) ->\r\n      if err?\r\n        console.dir err\r\n        next err\r\n      else next()"]],"start1":612,"start2":612,"length1":16,"length2":643}]],"length":1255,"saved":false}
{"ts":1356037183293,"patch":[[{"diffs":[[0,"xports ="],[1," (demuxSize)"],[0," ->\r\n  p"]],"start1":131,"start2":131,"length1":16,"length2":28}]],"length":1267,"saved":false}
{"ts":1356037317707,"patch":[[{"diffs":[[0,"x-mpu'\r\n"],[1,"# @see:\r\n# https://github.com/Obvious/pipette\r\n# https://github.com/dominictarr/mux-demux"],[0,"\r\nmodule"]],"start1":113,"start2":113,"length1":16,"length2":105}]],"length":1356,"saved":false}
{"ts":1356037320157,"patch":[[{"diffs":[[0,"-demux\r\n"],[1,"\r\n"],[0,"module.e"]],"start1":204,"start2":204,"length1":16,"length2":18}]],"length":1358,"saved":false}
{"ts":1356039637859,"patch":[[{"diffs":[[0,"x-demux\r"],[1,"\n# https://github.com/substack/stream-handbook\r"],[0,"\n\r\nmodul"]],"start1":203,"start2":203,"length1":16,"length2":63}]],"length":1405,"saved":false}
{"ts":1356040065451,"patch":[[{"diffs":[[0,"andbook\r"],[1,"\n# https://groups.google.com/forum/#!topic/nodejs-dev/djqqFhrObB8\r"],[0,"\n\r\nmodul"]],"start1":250,"start2":250,"length1":16,"length2":82}]],"length":1471,"saved":false}
{"ts":1356040090938,"patch":[[{"diffs":[[0,"m/forum/"],[1,"?fromgroups="],[0,"#!topic/"]],"start1":285,"start2":285,"length1":16,"length2":28},{"diffs":[[0,"dejs"],[-1,"-dev/djqqFhrObB8"],[1,"/4e3gphdKos0"],[0,"\r\n\r\n"]],"start1":315,"start2":315,"length1":24,"length2":20}]],"length":1479,"saved":false}
{"ts":1356040298720,"patch":[[{"diffs":[[0,"phdKos0\r"],[1,"\n# https://groups.google.com/forum/?fromgroups=#!topic/nodejs/Avf95ibIqHo\r"],[0,"\n\r\nmodul"]],"start1":324,"start2":324,"length1":16,"length2":90}]],"length":1553,"saved":false}
{"ts":1356040315173,"patch":[[{"diffs":[[0,"95ibIqHo"],[1,"    <---"],[0,"\r\n\r\nmodu"]],"start1":397,"start2":397,"length1":16,"length2":24}]],"length":1561,"saved":false}
{"ts":1356040538841,"patch":[[{"diffs":[[0,"   <---\r"],[1,"\n# https://github.com/Obvious/pipette/blob/danfuzz-write/lib/tee.js\r"],[0,"\n\r\nmodul"]],"start1":406,"start2":406,"length1":16,"length2":84}]],"length":1629,"saved":false}
{"ts":1356043121398,"patch":[[{"diffs":[[0,"/tee.js\r"],[1,"\n# https://github.com/mikeal/morestreams/blob/master/main.js (buffered streams)\r"],[0,"\n\r\nmodul"]],"start1":474,"start2":474,"length1":16,"length2":96}]],"length":1709,"saved":false}
{"ts":1356043559268,"patch":[[{"diffs":[[0," = ("],[-1,"demuxSize) ->"],[1,"options) ->\r\n  processPart = options.processPart || (part, done) ->\r\n    done [part]\r\n    "],[0,"\r\n  "]],"start1":579,"start2":579,"length1":21,"length2":98}]],"length":1786,"saved":false}
{"ts":1356044465709,"patch":[[{"diffs":[[0,"    done"],[1," null,"],[0," [part]\r"]],"start1":652,"start2":652,"length1":16,"length2":22},{"diffs":[[0," = ("],[-1,"objectName, "],[0,"stre"]],"start1":691,"start2":691,"length1":20,"length2":8},{"diffs":[[0,"ctName: "],[-1,"objectN"],[1,"stream.filen"],[0,"ame\r\n   "]],"start1":847,"start2":847,"length1":23,"length2":28},{"diffs":[[0,"part, cb) ->"],[-1,""],[0,""],[1,"\r\n    processPart part, (err, parts) ->\r\n      async.map parts, pushToS3, (err, results) ->\r\n        cb err, results\r\n      \r\n      "],[0,"\r\n    # http"]],"start1":932,"start2":932,"length1":24,"length2":156}]],"length":1917,"saved":false}
{"ts":1356044557572,"patch":[[{"diffs":[[0,"ibIqHo\r\n"],[1,"    ###\r\n"],[0,"    asyn"]],"start1":1148,"start2":1148,"length1":16,"length2":25},{"diffs":[[0,"    cb err\r\n"],[1,"    ###\r\n"],[0,"      \r\n  ha"]],"start1":1279,"start2":1279,"length1":24,"length2":33}]],"length":1935,"saved":false}
{"ts":1356044656170,"patch":[[{"diffs":[[0,"art || ("],[-1,"part"],[1,"readStream"],[0,", done) "]],"start1":628,"start2":628,"length1":20,"length2":26},{"diffs":[[0,"ToS3 = ("],[-1,"s"],[1,"readS"],[0,"tream, c"]],"start1":693,"start2":693,"length1":17,"length2":21},{"diffs":[[0,"ctName: "],[-1,"s"],[1,"readS"],[0,"tream.fi"]],"start1":857,"start2":857,"length1":17,"length2":21},{"diffs":[[0,"stream: "],[-1,"s"],[1,"readS"],[0,"tream\r\n "]],"start1":892,"start2":892,"length1":17,"length2":21},{"diffs":[[0,"Part = ("],[-1,"part"],[1,"readStream"],[0,", cb) ->"]],"start1":942,"start2":942,"length1":20,"length2":26},{"diffs":[[0,"art "],[-1,"part, (err, part"],[1,"readStream, (err, readStream"],[0,"s) -"]],"start1":982,"start2":982,"length1":24,"length2":36},{"diffs":[[0,"ync.map "],[-1,"part"],[1,"readStream"],[0,"s, pushT"]],"start1":1029,"start2":1029,"length1":20,"length2":26}]],"length":1977,"saved":false}
{"ts":1356044858393,"patch":[[{"diffs":[[0,"x-mpu'\r\n"],[1,"util = require 'util'\r\n\r\n"],[0,"# @see:\r"]],"start1":113,"start2":113,"length1":16,"length2":41}]],"length":2002,"saved":false}
{"ts":1356044895111,"patch":[[{"diffs":[[0,"am, cb) ->\r\n"],[1,"    # TODO: verify that processPart's signature is ok b4 proceeding\r\n"],[0,"    processP"]],"start1":983,"start2":983,"length1":24,"length2":93}]],"length":2071,"saved":false}
